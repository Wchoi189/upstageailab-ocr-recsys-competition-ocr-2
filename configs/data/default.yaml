# @package _group_

defaults:
  - /data/transforms/base@transforms
  - _self_

batch_size: 4

train_num_samples: null
val_num_samples: null
test_num_samples: null

# Dataset Definitions (Flattened)
train_dataset:
  _target_: ocr.data.datasets.ValidatedOCRDataset
  config:
    _target_: ocr.core.validation.DatasetConfig
    image_path: ${global.paths.datasets_root}/images/train
    annotation_path: ${global.paths.datasets_root}/jsons/train.json
    enable_background_normalization: false
    cache_config:
      _target_: ocr.core.validation.CacheConfig
      cache_transformed_tensors: false
      cache_images: false
      cache_maps: false
      log_statistics_every_n: null
  transform: ${transforms.train_transform}

val_dataset:
  _target_: ocr.data.datasets.ValidatedOCRDataset
  config:
    _target_: ocr.core.validation.DatasetConfig
    image_path: ${global.paths.datasets_root}/images_val_canonical
    annotation_path: ${global.paths.datasets_root}/jsons/val.json
    enable_background_normalization: false
    preload_images: false
    load_maps: false
    cache_config:
      _target_: ocr.core.validation.CacheConfig
      cache_transformed_tensors: false
      cache_images: false
      cache_maps: false
      log_statistics_every_n: null
  transform: ${transforms.val_transform}

test_dataset:
  _target_: ocr.data.datasets.ValidatedOCRDataset
  config:
    _target_: ocr.core.validation.DatasetConfig
    image_path: ${global.paths.datasets_root}/images_val_canonical
    annotation_path: ${global.paths.datasets_root}/jsons/val.json
    enable_background_normalization: false
  transform: ${transforms.test_transform}

predict_dataset:
  _target_: ocr.data.datasets.ValidatedOCRDataset
  config:
    _target_: ocr.core.validation.DatasetConfig
    image_path: ${global.paths.datasets_root}/images/test
    annotation_path: null
    enable_background_normalization: false
  transform: ${transforms.test_transform}

collate_fn:
  _target_: ocr.domains.detection.data.collate_db.DBCollateFN
  shrink_ratio: 0.4
  thresh_min: 0.3
  thresh_max: 0.7
