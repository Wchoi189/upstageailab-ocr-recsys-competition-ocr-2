# @package _global_

defaults:
  - _self_
  - paths: default
  - hydra: default

seed: 42
debug: false
print_config: true
ignore_warnings: true

project_name: "ocr-kie"
run_name: "kie-layoutlmv3-base"
use_wandb: true

model:
  type: "layoutlmv3"
  pretrained_model_name_or_path: "microsoft/layoutlmv3-base"
  num_labels: 32  # 31 entities + 1 (O) - simple format, not BIO
  max_length: 512

data:
  train_path: "data/processed/aligned/baseline_kie_dp_train.parquet"
  val_path: "data/processed/aligned/baseline_kie_dp_val.parquet"
  image_dir: "." # Paths in parquet are relative to project root (e.g., data/datasets/...)
  # 32 labels: O + 31 entity types (simple format matching aligned data)
  label_list: [
    "O",
    "approval_code", "branch_name", "card_payment_price", "cash_payment_price",
    "cc_code", "cc_expiry", "cc_number", "change", "charged_price",
    "coupon_payment_price", "group_0", "installment", "payment_price",
    "product_name", "store_address", "store_name", "store_phone_number",
    "store_registration_number", "subtotal_price", "tax_price", "tip_price",
    "transaction_date", "unit_product_code", "unit_product_discounted_price",
    "unit_product_discounted_reason", "unit_product_order", "unit_product_price",
    "unit_product_quantity", "unit_product_total_price_after_discount",
    "unit_product_total_price_before_discount", "voucher_payment_price"
  ]

train:
  batch_size: 12
  num_workers: 8
  max_epochs: 15
  devices: 1
  accelerator: "gpu"
  precision: "16-mixed"  # Enable mixed precision for speed and memory efficiency
  warmup_steps: 100  # LR warmup for training stability
