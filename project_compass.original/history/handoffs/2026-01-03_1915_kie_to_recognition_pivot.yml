# SESSION HANDOFF ARCHIVE
# Date: 2026-01-03 19:15 (KST)
# Session: KIE → Text Recognition Pivot

session_id: 20260103_session_01
date: "2026-01-03"
time: "19:15 (KST)"
duration_hours: 2
phase_transition:
  from: "kie"
  to: "recognition"
  reason: "Document Parse API limitation for receipts"

accomplishments:
  - title: "Debugged KIE Training"
    description: "Fixed label mismatch (BIO→simple), achieved val_F1=0.623"
    impact: "Proved training pipeline works, but revealed fundamental data issues"

  - title: "Discovered Document Parse Limitation"
    description: "Document Parse treats receipts as tables, not text blocks"
    impact: "Critical finding that invalidated entire KIE+DP approach"

  - title: "Strategic Pivot Decision"
    description: "Abandoned KIE+DP, pivoted to text recognition on AI Hub dataset"
    impact: "Redirected project to more promising path"

datasets_modified:
  deprecated:
    - name: "baseline_kie_dp_train"
      path: "data/processed/aligned/baseline_kie_dp_train.parquet"
      reason: "HTML contaminated, broken bboxes"
    - name: "baseline_kie_dp_val"
      path: "data/processed/aligned/baseline_kie_dp_val.parquet"
      reason: "HTML contaminated, broken bboxes"

  ready:
    - name: "aihub_validation_optimized_v2"
      path: "data/optimized_images_v2/aihub_validation/"
      status: "Ready for text recognition training"

key_lessons:
  - "Document Parse API is optimized for forms/reports, not receipts"
  - "Receipts don't require layout analysis (linear text structure)"
  - "Always validate API outputs before building pipelines (5 min test saves days)"

next_session_focus:
  primary_goal: "Build text recognition pipeline on AI Hub dataset"
  tasks:
    - "Verify AI Hub parquet image paths"
    - "Create word-crop extraction script"
    - "Train PARSeq or CRNN recognizer"
    - "Validate Korean text recognition"

blockers:
  - issue: "Image path verification needed"
    status: "pending"
  - issue: "Text recognition pipeline audit required"
    status: "investigating"

artifacts:
  - type: "walkthrough"
    path: "/home/vscode/.gemini/antigravity/brain/ff1e2aa9-0a2a-4b92-baee-4c9e31fea213/walkthrough.md.resolved"
  - type: "assessment"
    path: "/home/vscode/.gemini/antigravity/brain/ff1e2aa9-0a2a-4b92-baee-4c9e31fea213/assessment_kie_dp_failure.md.resolved"
  - type: "wandb_run"
    url: "https://wandb.ai/ocr-team2/ocr-kie/runs/e7l6f9k4"

files_modified:
  - "configs/train_kie.yaml"
  - "runners/train_kie.py"
  - "configs/train_kie_baseline_optimized_v2.yaml"
