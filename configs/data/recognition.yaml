# @package data
# Recognition Dataset Configuration
# Used for text recognition models (PARSeq)

defaults:
  - /data/transforms/recognition@transforms

# Data Globals
batch_size: 128
num_workers: 4

# Tokenizer
tokenizer:
  _target_: ocr.features.recognition.data.tokenizer.KoreanOCRTokenizer
  char_path: ${global.paths.root_dir}/ocr/data/charset.json
  max_len: 25

# Dataset Template
_dataset_template: &dataset_template
  _target_: ocr.features.recognition.data.lmdb_dataset.LMDBRecognitionDataset
  lmdb_path: ${global.paths.datasets.train}/recognition/aihub_lmdb_validation
  tokenizer: ${data.tokenizer}
  max_len: ${data.tokenizer.max_len}
  transform: ${data.transforms}
  config: null  # Suppress inherited 'config' key from base.yaml merge

# Explicit dataset definitions for factory (at root/datasets)
datasets:
  train_dataset:
    <<: *dataset_template

  val_dataset:
    <<: *dataset_template

  test_dataset:
    <<: *dataset_template

  predict_dataset:
    <<: *dataset_template

# Collate (at root)
collate_fn:
  _target_: ocr.data.datasets.recognition_collate_fn.recognition_collate_fn
  _partial_: true
