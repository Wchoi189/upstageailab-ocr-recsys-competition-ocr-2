ads_version: '2.0'
type: rule_set
agent: all
tier: 2
priority: high
pydantic_validation_rules:
  version: pydantic v2
  mandatory_locations:
  - Dataset __getitem__ inputs/outputs
  - Transform pipeline input/output contracts
  - API request/response models
  - Configuration dataclasses
  - Cache serialization boundaries
  prohibited_patterns:
  - Passing raw dicts between pipeline stages
  - Unvalidated numpy array shapes
  - Tensor dtype assumptions without validation
  - Config values accessed without schema
  required_features:
    config: ConfigDict(arbitrary_types_allowed=True)
    field_validation: field_validator for shape/dtype checks
    cross_field: model_validator for cross-field validation
    errors: Descriptive ValidationError messages
  patterns:
    prohibited:
      description: Raw dict passing
      example: "def process(data: dict) -> dict:\n    return {\"result\": data[\"\
        input\"] * 2}\n"
    required:
      description: Pydantic model contracts
      example: "class ProcessInput(BaseModel):\n    model_config = ConfigDict(arbitrary_types_allowed=True)\n\
        \    input: np.ndarray\n\n    @field_validator(\"input\")\n    @classmethod\n\
        \    def validate_shape(cls, v):\n        if v.ndim != 2:\n            raise\
        \ ValueError(\"Must be 2D\")\n        return v\n\nclass ProcessOutput(BaseModel):\n\
        \    result: np.ndarray\n\ndef process(data: ProcessInput) -> ProcessOutput:\n\
        \    return ProcessOutput(result=data.input * 2)\n"
  reference_implementations:
    core_validation: ocr/core/validation.py
    schemas_shim: ocr/data/datasets/schemas.py
    validation_shim: ocr/core/validation.py
    contracts: ocr/data/datasets/preprocessing/contracts.py
    transforms: ocr/data/datasets/transforms.py
id: FW-029
validates_with: AgentQMS/standards/schemas/compliance-checker.py
compliance_status: unknown
memory_footprint: 100
keywords:
- pydantic
- validation
- rules
fuzzy_threshold: 0.8
