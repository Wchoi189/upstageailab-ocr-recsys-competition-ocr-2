---
# Frontend State Management - InferenceContext
# Location: apps/ocr-inference-console/src/contexts/InferenceContext.tsx

InferenceContext:
  pattern: "React Context API"
  provider: "InferenceProvider"
  hook: "useInference()"
  location: "src/contexts/InferenceContext.tsx"

state:
  checkpoints: "Checkpoint[]"
  loadingCheckpoints: "boolean"
  retryCount: "number (0-5)"
  selectedCheckpoint: "string | null"
  inferenceOptions: "InferenceOptions"

actions:
  setSelectedCheckpoint:
    signature: "(path: string | null) => void"
    behavior: "Update selected checkpoint path"

  updateInferenceOptions:
    signature: "(opts: Partial<InferenceOptions>) => void"
    behavior: "Merge partial options into current state"

  refreshCheckpoints:
    signature: "() => Promise<void>"
    behavior: "Retry checkpoint loading with exponential backoff (1s, 2s, 5s, 10s, 20s)"

initialization:
  - "Load checkpoints on mount with retry logic"
  - "Auto-select first checkpoint if none selected"
  - "Max 5 retries with exponential backoff"

usage_pattern: |
  import { useInference } from './contexts/InferenceContext';

  const { checkpoints, selectedCheckpoint, setSelectedCheckpoint, inferenceOptions, updateInferenceOptions } = useInference();

state_flow:
  checkpoint_loading:
    - "loadingCheckpoints = true"
    - "Call ocrClient.listCheckpoints()"
    - "If empty & retry < 5: wait (1s, 2s, 5s, 10s, 20s) and retry"
    - "If success: setCheckpoints(), auto-select first if none selected"
    - "loadingCheckpoints = false"
