{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Current Session Context",
  "description": "Short-term working memory for the active AI session. Focuses on immediate goals and environmental locks.",
  "type": "object",
  "required": ["session_id", "objective", "env_lock"],
  "properties": {
    "session_id": {
      "type": "string",
      "description": "Unique identifier for the current turn/session."
    },
    "objective": {
      "type": "object",
      "required": ["primary_goal", "active_pipeline"],
      "properties": {
        "primary_goal": {
          "type": "string"
        },
        "active_pipeline": {
          "type": "string",
          "enum": ["text_detection", "text_recognition", "layout_analysis", "kie"]
        },
        "success_criteria": {
          "type": "string"
        }
      }
    },
    "env_lock": {
      "type": "object",
      "required": ["uv_path", "python_version"],
      "properties": {
        "uv_path": {
          "type": "string"
        },
        "python_version": {
          "type": "string"
        },
        "is_gpu_required": {
          "type": "boolean"
        },
        "verified_at": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2} \\(KST\\)$",
          "description": "Timestamp in format: YYYY-MM-DD HH:MM (KST)"
        }
      }
    },
    "active_blockers": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["issue", "status"],
        "properties": {
          "issue": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["blocked", "investigating", "resolved"]
          },
          "impact": {
            "type": "string"
          }
        }
      }
    },
    "working_references": {
      "type": "object",
      "description": "Links to specific files or experiments currently being touched.",
      "properties": {
        "experiment_id": {
          "type": "string"
        },
        "checkpoint_path": {
          "type": "string"
        },
        "dataset_name": {
          "type": "string"
        }
      }
    }
  }
}
