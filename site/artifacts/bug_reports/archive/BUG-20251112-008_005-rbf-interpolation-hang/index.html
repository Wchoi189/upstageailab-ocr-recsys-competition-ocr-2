<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="AI Competition: Receipt Text Detection with DBNet baseline"><meta name=author content=Wchoi189><link href=https://wchoi189.github.io/upstageailab-ocr-recsys-competition-ocr-2/artifacts/bug_reports/archive/BUG-20251112-008_005-rbf-interpolation-hang/ rel=canonical><link rel=icon href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>Bug 20251112 008 005 Rbf Interpolation Hang - OCR Receipt Text Detection - Continuation</title><link rel=stylesheet href=../../../../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../css/timeago.css><link rel=stylesheet href=../../../../stylesheets/extra.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#bug_2025_005-rbf-interpolation-performance-hang class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="OCR Receipt Text Detection - Continuation" class="md-header__button md-logo" aria-label="OCR Receipt Text Detection - Continuation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> OCR Receipt Text Detection - Continuation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Bug 20251112 008 005 Rbf Interpolation Hang </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=blue aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 256 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Wchoi189/upstageailab-ocr-recsys-competition-ocr-2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Wchoi189/upstageailab-ocr-recsys-competition-ocr-2 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../assessments/ class=md-tabs__link> Artifacts </a> </li> <li class=md-tabs__item> <a href=../../../../changelog/ class=md-tabs__link> System Documentation </a> </li> <li class=md-tabs__item> <a href=../../../../archive/ class=md-tabs__link> Archive </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="OCR Receipt Text Detection - Continuation" class="md-nav__button md-logo" aria-label="OCR Receipt Text Detection - Continuation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> OCR Receipt Text Detection - Continuation </label> <div class=md-nav__source> <a href=https://github.com/Wchoi189/upstageailab-ocr-recsys-competition-ocr-2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Wchoi189/upstageailab-ocr-recsys-competition-ocr-2 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../assessments/ class=md-nav__link> <span class=md-ellipsis> Artifacts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../changelog/ class=md-nav__link> <span class=md-ellipsis> System Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../archive/ class=md-nav__link> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/Wchoi189/upstageailab-ocr-recsys-competition-ocr-2/edit/main/docs/artifacts/bug_reports/archive/BUG-20251112-008_005-rbf-interpolation-hang.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/Wchoi189/upstageailab-ocr-recsys-competition-ocr-2/raw/main/docs/artifacts/bug_reports/archive/BUG-20251112-008_005-rbf-interpolation-hang.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=bug_2025_005-rbf-interpolation-performance-hang>BUG_2025_005: RBF Interpolation Performance Hang<a class=headerlink href=#bug_2025_005-rbf-interpolation-performance-hang title="Anchor link to this section for reference">&para;</a></h1> <p><strong>Date Reported</strong>: 2025-10-18 <strong>Severity</strong>: üî¥ CRITICAL <strong>Status</strong>: ‚úÖ FIXED <strong>Reporter</strong>: Debug Session (AI) <strong>Component</strong>: Document Flattening (<code>ocr/datasets/preprocessing/document_flattening.py</code>)</p> <hr> <h2 id=summary>Summary<a class=headerlink href=#summary title="Anchor link to this section for reference">&para;</a></h2> <p>The Streamlit Preprocessing Viewer app hangs indefinitely when document flattening is enabled, consuming 130%+ CPU with no progress. The root cause was <strong>RBF interpolation computing displacements for every pixel</strong> in full-resolution images, resulting in <strong>O(N √ó M) complexity explosion</strong> (N = control points, M = pixels).</p> <hr> <h2 id=technical-details>Technical Details<a class=headerlink href=#technical-details title="Anchor link to this section for reference">&para;</a></h2> <h3 id=root-cause>Root Cause<a class=headerlink href=#root-cause title="Anchor link to this section for reference">&para;</a></h3> <p><strong>Location</strong>: document_flattening.py:497-536 (<code>_apply_rbf_warping</code> method)</p> <p><strong>Problem</strong>: The RBF interpolation was computing warping displacements for every single pixel in the original high-resolution image:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># BEFORE FIX (lines 516-527):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>rbf_x</span> <span class=o>=</span> <span class=n>Rbf</span><span class=p>(</span><span class=n>source_points</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>source_points</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>dx</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>rbf_y</span> <span class=o>=</span> <span class=n>Rbf</span><span class=p>(</span><span class=n>source_points</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>source_points</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>dy</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=c1># Create coordinate grids - FULL RESOLUTION!</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>x_coords</span><span class=p>,</span> <span class=n>y_coords</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>w</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>h</span><span class=p>))</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=c1># Calculate displacements - O(N * M) where M = w * h</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>dx_map</span> <span class=o>=</span> <span class=n>rbf_x</span><span class=p>(</span><span class=n>x_coords</span><span class=p>,</span> <span class=n>y_coords</span><span class=p>)</span>  <span class=c1># Computes for EVERY pixel!</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>dy_map</span> <span class=o>=</span> <span class=n>rbf_y</span><span class=p>(</span><span class=n>x_coords</span><span class=p>,</span> <span class=n>y_coords</span><span class=p>)</span>  <span class=c1># Computes for EVERY pixel!</span>
</span></code></pre></div> <p><strong>Complexity Analysis</strong>: - For a 2000√ó1500 image: M = 3,000,000 pixels - With 20√ó20 grid: N = 400 control points - <strong>Total operations</strong>: N √ó M = <strong>1.2 billion interpolation calculations</strong> - <strong>Time to complete</strong>: 3-15 seconds per image (if it completes at all)</p> <h3 id=observable-symptoms>Observable Symptoms<a class=headerlink href=#observable-symptoms title="Anchor link to this section for reference">&para;</a></h3> <ol> <li><strong>UI Behavior</strong>:</li> <li>Spinner shows "Running preprocessing pipeline..." indefinitely</li> <li>No progress indication</li> <li>No error messages</li> <li> <p>Browser appears frozen but is actually waiting</p> </li> <li> <p><strong>System Behavior</strong>:</p> </li> <li>Process consuming <strong>130-134% CPU</strong> (stuck in compute loop)</li> <li>Memory usage: ~1.0-1.1GB (normal for image processing)</li> <li>No timeout, no crash</li> <li> <p>Last log before hang: <code>"Initialized IntelligentBrightnessAdjuster with method: auto"</code></p> </li> <li> <p><strong>Process State</strong>: <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>$<span class=w> </span>ps<span class=w> </span>aux<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>streamlit
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>vscode<span class=w>   </span><span class=m>3690890</span><span class=w>  </span><span class=m>134</span><span class=w>  </span><span class=m>0</span>.3<span class=w> </span><span class=m>10264076</span><span class=w> </span><span class=m>899636</span><span class=w> </span>?<span class=w>     </span>Sl<span class=w>   </span><span class=m>23</span>:34<span class=w>   </span><span class=m>4</span>:18<span class=w> </span>streamlit<span class=w> </span>run<span class=w> </span>...
</span></code></pre></div></p> </li> </ol> <hr> <h2 id=fix-implementation>Fix Implementation<a class=headerlink href=#fix-implementation title="Anchor link to this section for reference">&para;</a></h2> <h3 id=solution-image-downsampling-for-rbf-computation>Solution: Image Downsampling for RBF Computation<a class=headerlink href=#solution-image-downsampling-for-rbf-computation title="Anchor link to this section for reference">&para;</a></h3> <p><strong>Strategy</strong>: Downsample image to ~800px on longest edge before RBF interpolation, then upsample the warped result back to original resolution.</p> <p><strong>Location</strong>: document_flattening.py:515-563</p> <p><strong>Key Changes</strong>: <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># AFTER FIX:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>MAX_DIMENSION</span> <span class=o>=</span> <span class=mi>800</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=k>if</span> <span class=nb>max</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MAX_DIMENSION</span><span class=p>:</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=n>scale</span> <span class=o>=</span> <span class=n>MAX_DIMENSION</span> <span class=o>/</span> <span class=nb>max</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=n>downsample_h</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>h</span> <span class=o>*</span> <span class=n>scale</span><span class=p>)</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>    <span class=n>downsample_w</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>w</span> <span class=o>*</span> <span class=n>scale</span><span class=p>)</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>    <span class=n>downsampled_image</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=p>(</span><span class=n>downsample_w</span><span class=p>,</span> <span class=n>downsample_h</span><span class=p>),</span> <span class=n>interpolation</span><span class=o>=</span><span class=n>cv2</span><span class=o>.</span><span class=n>INTER_AREA</span><span class=p>)</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>    <span class=c1># Scale control points proportionally</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>    <span class=n>scaled_source</span> <span class=o>=</span> <span class=n>source_points</span> <span class=o>*</span> <span class=n>scale</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>    <span class=n>scaled_target</span> <span class=o>=</span> <span class=n>target_points</span> <span class=o>*</span> <span class=n>scale</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=k>else</span><span class=p>:</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>    <span class=c1># Use original resolution if already small</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>    <span class=n>downsampled_image</span> <span class=o>=</span> <span class=n>image</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>    <span class=n>scaled_source</span> <span class=o>=</span> <span class=n>source_points</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>    <span class=n>scaled_target</span> <span class=o>=</span> <span class=n>target_points</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=c1># Perform RBF on downsampled resolution</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=n>rbf_x</span> <span class=o>=</span> <span class=n>Rbf</span><span class=p>(</span><span class=n>scaled_source</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>scaled_source</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>dx</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=n>rbf_y</span> <span class=o>=</span> <span class=n>Rbf</span><span class=p>(</span><span class=n>scaled_source</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>scaled_source</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>dy</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>x_coords</span><span class=p>,</span> <span class=n>y_coords</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>downsample_w</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>downsample_h</span><span class=p>))</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=n>dx_map</span> <span class=o>=</span> <span class=n>rbf_x</span><span class=p>(</span><span class=n>x_coords</span><span class=p>,</span> <span class=n>y_coords</span><span class=p>)</span>  <span class=c1># Now operating on ~640K pixels instead of 3M!</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=n>dy_map</span> <span class=o>=</span> <span class=n>rbf_y</span><span class=p>(</span><span class=n>x_coords</span><span class=p>,</span> <span class=n>y_coords</span><span class=p>)</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=c1># Apply warping</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=n>warped_downsampled</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>remap</span><span class=p>(</span><span class=n>downsampled_image</span><span class=p>,</span> <span class=n>map_x</span><span class=p>,</span> <span class=n>map_y</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=c1># Upsample back to original resolution</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=k>if</span> <span class=nb>max</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MAX_DIMENSION</span><span class=p>:</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a>    <span class=n>warped</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>warped_downsampled</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>h</span><span class=p>),</span> <span class=n>interpolation</span><span class=o>=</span><span class=n>cv2</span><span class=o>.</span><span class=n>INTER_LINEAR</span><span class=p>)</span>
</span></code></pre></div></p> <h3 id=performance-impact>Performance Impact<a class=headerlink href=#performance-impact title="Anchor link to this section for reference">&para;</a></h3> <p><strong>Before Fix</strong>: - 2000√ó1500 image: 3,000,000 pixels √ó 400 control points = <strong>1.2 billion operations</strong> - Time: 3-15 seconds (or infinite hang)</p> <p><strong>After Fix</strong>: - 2000√ó1500 image downsampled to 800√ó600: 480,000 pixels √ó 400 control points = <strong>192 million operations</strong> - Time: &lt;1 second - <strong>Speedup</strong>: ~63√ó reduction in computational cost - Quality: Minimal loss due to smoothness of thin plate spline warping</p> <h3 id=trade-offs>Trade-offs<a class=headerlink href=#trade-offs title="Anchor link to this section for reference">&para;</a></h3> <p>‚úÖ <strong>Benefits</strong>: - Eliminates hang completely - Processing time: &lt;1 second vs 3-15 seconds - Makes document flattening practically usable in interactive UI - No changes to public API</p> <p>‚ö†Ô∏è <strong>Limitations</strong>: - Slight quality loss for fine details in warping (acceptable for document flattening) - Warping is computed at lower resolution, then scaled up - Still computationally expensive (just not prohibitively so)</p> <hr> <h2 id=verification>Verification<a class=headerlink href=#verification title="Anchor link to this section for reference">&para;</a></h2> <h3 id=test-procedure>Test Procedure<a class=headerlink href=#test-procedure title="Anchor link to this section for reference">&para;</a></h3> <ol> <li> <p><strong>Before Fix</strong>: <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Start app</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>uv<span class=w> </span>run<span class=w> </span>streamlit<span class=w> </span>run<span class=w> </span>ui/preprocessing_viewer_app.py<span class=w> </span>--server.port<span class=w> </span><span class=m>8501</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># Upload image ‚Üí Enable document flattening ‚Üí Run Full Pipeline</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=c1># Result: Indefinite hang with 134% CPU usage</span>
</span></code></pre></div></p> </li> <li> <p><strong>After Fix</strong>: <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Kill hanging process</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nb>kill</span><span class=w> </span>-9<span class=w> </span><span class=m>3690890</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># Restart app with fix</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>uv<span class=w> </span>run<span class=w> </span>streamlit<span class=w> </span>run<span class=w> </span>ui/preprocessing_viewer_app.py<span class=w> </span>--server.port<span class=w> </span><span class=m>8501</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Upload image ‚Üí Enable document flattening ‚Üí Run Full Pipeline</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=c1># Result: Pipeline completes in &lt;5 seconds, flattened image displayed</span>
</span></code></pre></div></p> </li> </ol> <h3 id=verification-results>Verification Results<a class=headerlink href=#verification-results title="Anchor link to this section for reference">&para;</a></h3> <p>‚úÖ <strong>Success Criteria Met</strong>: - Pipeline completes without hanging - CPU usage normal (stays at ~130% for Streamlit event loop, not stuck) - Logs show pipeline completion: <code>"Starting preprocessing pipeline"</code> ‚Üí completes - Flattened image is generated and displayed correctly - App remains responsive throughout</p> <p><strong>CPU Before/After</strong>: <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Before fix (hanging):</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>%CPU<span class=w>   </span>RSS<span class=w>      </span>ETIME<span class=w>  </span>STAT
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=m>134</span><span class=w>   </span><span class=m>899636</span><span class=w>   </span>infinite<span class=w> </span>Sl<span class=w> </span><span class=o>(</span>stuck<span class=w> </span><span class=k>in</span><span class=w> </span>RBF<span class=w> </span>computation<span class=o>)</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=c1># After fix (working):</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>%CPU<span class=w>   </span>RSS<span class=w>      </span>ETIME<span class=w>  </span>STAT
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=m>130</span><span class=w>  </span><span class=m>1041556</span><span class=w>   </span><span class=m>02</span>:27<span class=w>  </span>Sl<span class=w> </span><span class=o>(</span>normal<span class=w> </span>event<span class=w> </span>loop<span class=w> </span>processing<span class=o>)</span>
</span></code></pre></div></p> <hr> <h2 id=impact-assessment>Impact Assessment<a class=headerlink href=#impact-assessment title="Anchor link to this section for reference">&para;</a></h2> <h3 id=severity-justification>Severity Justification<a class=headerlink href=#severity-justification title="Anchor link to this section for reference">&para;</a></h3> <p><strong>Critical</strong> because: 1. ‚úÖ Completely blocks app functionality (infinite hang) 2. ‚úÖ No workaround for users (except disabling flattening) 3. ‚úÖ Affects all document flattening operations 4. ‚úÖ Silent failure (no error message, just hangs) 5. ‚úÖ Resource exhaustion (CPU pinned at 130%+)</p> <h3 id=affected-components>Affected Components<a class=headerlink href=#affected-components title="Anchor link to this section for reference">&para;</a></h3> <ol> <li><strong>Streamlit Preprocessing Viewer</strong> (<code>ui/preprocessing_viewer_app.py</code>):</li> <li>Full Pipeline tab: Completely broken with flattening enabled</li> <li> <p>Step-by-Step Visualizer: Would hang on flattening stage</p> </li> <li> <p><strong>Document Flattener</strong> (<code>ocr/datasets/preprocessing/document_flattening.py</code>):</p> </li> <li>All warping methods: <code>_thin_plate_spline_warping</code>, <code>_cylindrical_warping</code>, <code>_spherical_warping</code>, <code>_adaptive_warping</code></li> <li> <p>Any code path calling <code>_apply_rbf_warping</code></p> </li> <li> <p><strong>Potential Training Pipeline Impact</strong>:</p> </li> <li>If document flattening is enabled in preprocessing config</li> <li>Would cause massive training slowdown (3-15s per image)</li> <li>Currently disabled by default, so no immediate training impact</li> </ol> <hr> <h2 id=related-issues>Related Issues<a class=headerlink href=#related-issues title="Anchor link to this section for reference">&para;</a></h2> <h3 id=connection-to-previous-debugging>Connection to Previous Debugging<a class=headerlink href=#connection-to-previous-debugging title="Anchor link to this section for reference">&para;</a></h3> <p>This bug was identified during the <strong>Preprocessing Viewer Debug Session</strong> (preprocessing_viewer_debug_session.md).</p> <p><strong>Initial Hypothesis</strong> (from debug session):</p> <blockquote> <p>"Document flattening is enabled by default (True) and takes 3-15 seconds per image according to Phase 2 validation results."</p> </blockquote> <p><strong>Reality</strong>: The problem wasn't just "slow execution" - it was <strong>O(N√óM) complexity explosion</strong> making it effectively infinite for high-resolution images.</p> <h3 id=comparison-to-bug_2025_004>Comparison to BUG_2025_004<a class=headerlink href=#comparison-to-bug_2025_004 title="Anchor link to this section for reference">&para;</a></h3> <p>See BUG_2025_004_STREAMLIT_VIEWER_HANGING.md for the broader context of the Streamlit viewer hanging issue. This bug (BUG_2025_005) is the <strong>root cause</strong> identified during that investigation.</p> <hr> <h2 id=recommendations>Recommendations<a class=headerlink href=#recommendations title="Anchor link to this section for reference">&para;</a></h2> <h3 id=immediate-actions-completed>Immediate Actions (Completed)<a class=headerlink href=#immediate-actions-completed title="Anchor link to this section for reference">&para;</a></h3> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Implement downsampling fix in <code>_apply_rbf_warping</code></li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Verify fix resolves hang</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Document fix in bug report</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Update CHANGELOG.md</li> </ul> <h3 id=short-term-improvements>Short-Term Improvements<a class=headerlink href=#short-term-improvements title="Anchor link to this section for reference">&para;</a></h3> <ol> <li> <p><strong>Add Progress Indicators</strong> (from original debug session plan): <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># In pipeline.py around line 187:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>if</span> <span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;enable_document_flattening&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=n>st</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=s2>&quot;Stage 3/8: Flattening document (may take 1-2 seconds)...&quot;</span><span class=p>)</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>flattened_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>document_flattener</span><span class=o>.</span><span class=n>flatten_document</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></code></pre></div></p> </li> <li> <p><strong>Add Timeout Protection</strong>: <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>import</span><span class=w> </span><span class=nn>signal</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kn>from</span><span class=w> </span><span class=nn>contextlib</span><span class=w> </span><span class=kn>import</span> <span class=n>contextmanager</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=nd>@contextmanager</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=k>def</span><span class=w> </span><span class=nf>timeout_context</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=k>def</span><span class=w> </span><span class=nf>timeout_handler</span><span class=p>(</span><span class=n>signum</span><span class=p>,</span> <span class=n>frame</span><span class=p>):</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>        <span class=k>raise</span> <span class=ne>TimeoutError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Stage exceeded </span><span class=si>{</span><span class=n>seconds</span><span class=si>}</span><span class=s2>s timeout&quot;</span><span class=p>)</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=n>signal</span><span class=o>.</span><span class=n>signal</span><span class=p>(</span><span class=n>signal</span><span class=o>.</span><span class=n>SIGALRM</span><span class=p>,</span> <span class=n>timeout_handler</span><span class=p>)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=n>signal</span><span class=o>.</span><span class=n>alarm</span><span class=p>(</span><span class=n>seconds</span><span class=p>)</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>        <span class=k>yield</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>    <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>        <span class=n>signal</span><span class=o>.</span><span class=n>alarm</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=c1># Usage:</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=k>try</span><span class=p>:</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>    <span class=k>with</span> <span class=n>timeout_context</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>        <span class=n>flattened_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>document_flattener</span><span class=o>.</span><span class=n>flatten_document</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=k>except</span> <span class=ne>TimeoutError</span><span class=p>:</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Flattening timeout - skipping&quot;</span><span class=p>)</span>
</span></code></pre></div></p> </li> <li> <p><strong>Add Configuration Warning</strong>: <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># In preset_manager.py or UI:</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>if</span> <span class=n>st</span><span class=o>.</span><span class=n>checkbox</span><span class=p>(</span><span class=s2>&quot;Enable document flattening&quot;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    <span class=n>st</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;‚ö†Ô∏è Document flattening adds 1-2s processing time per image&quot;</span><span class=p>)</span>
</span></code></pre></div></p> </li> </ol> <h3 id=medium-term-improvements>Medium-Term Improvements<a class=headerlink href=#medium-term-improvements title="Anchor link to this section for reference">&para;</a></h3> <ol> <li><strong>Alternative RBF Implementation</strong>:</li> <li>Consider OpenCV's Thin Plate Spline (<code>cv2.createThinPlateSplineShapeTransformer</code>)</li> <li> <p>May be faster than scipy's Rbf for image warping</p> </li> <li> <p><strong>Adaptive Grid Size</strong>: <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Reduce grid size for larger images</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=k>if</span> <span class=nb>max</span><span class=p>(</span><span class=n>h</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2000</span><span class=p>:</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>grid_size</span> <span class=o>=</span> <span class=mi>15</span>  <span class=c1># Instead of 20</span>
</span></code></pre></div></p> </li> <li> <p><strong>GPU Acceleration</strong> (future work):</p> </li> <li>Implement GPU-based RBF interpolation</li> <li>Could provide 10-100√ó additional speedup</li> <li>See Phase 3 documentation for details</li> </ol> <h3 id=long-term-architecture-changes>Long-Term Architecture Changes<a class=headerlink href=#long-term-architecture-changes title="Anchor link to this section for reference">&para;</a></h3> <ol> <li><strong>Preprocessing Preset System</strong>:</li> <li>"Fast" preset: Disable flattening (current default)</li> <li>"Quality" preset: Enable flattening with warning</li> <li> <p>"Office Lens" preset: Enable all expensive features</p> </li> <li> <p><strong>Async Processing</strong>:</p> </li> <li>Move expensive operations to background threads</li> <li> <p>Show incremental results as they complete</p> </li> <li> <p><strong>Caching</strong>:</p> </li> <li>Cache flattened results by image hash</li> <li>Avoid recomputation on parameter tweaks</li> </ol> <hr> <h2 id=testing-checklist>Testing Checklist<a class=headerlink href=#testing-checklist title="Anchor link to this section for reference">&para;</a></h2> <p>‚úÖ <strong>Verification Tests Passed</strong>: - [x] Full pipeline completes without hanging - [x] Document flattening produces valid output - [x] Processing time &lt;5 seconds for typical images - [x] CPU usage returns to normal after pipeline - [x] Memory usage remains stable - [x] No error logs or exceptions - [x] App remains responsive throughout</p> <p>üîÑ <strong>Regression Tests Needed</strong>: - [ ] Test with various image sizes (small, medium, large) - [ ] Test with different flattening methods (cylindrical, spherical, adaptive) - [ ] Test with different grid sizes (5, 10, 20, 50) - [ ] Compare flattening quality before/after fix (visual inspection) - [ ] Verify no impact on training pipeline (if flattening ever enabled)</p> <hr> <h2 id=code-locations>Code Locations<a class=headerlink href=#code-locations title="Anchor link to this section for reference">&para;</a></h2> <p><strong>Primary Fix</strong>: - document_flattening.py:497-563 - <code>_apply_rbf_warping</code> method</p> <p><strong>Affected Callers</strong>: - document_flattening.py:291-350 - <code>_thin_plate_spline_warping</code> - document_flattening.py:352-403 - <code>_cylindrical_warping</code> - document_flattening.py:405-447 - <code>_spherical_warping</code> - document_flattening.py:449-495 - <code>_adaptive_warping</code></p> <p><strong>UI Integration</strong>: - preprocessing_viewer_app.py:138-143 - Full pipeline execution - pipeline.py:184-201 - Document flattening stage</p> <p><strong>Related Documentation</strong>: - preprocessing_viewer_debug_session.md - Debug session - BUG_2025_004_STREAMLIT_VIEWER_HANGING.md - Parent issue</p> <hr> <h2 id=lessons-learned>Lessons Learned<a class=headerlink href=#lessons-learned title="Anchor link to this section for reference">&para;</a></h2> <h3 id=performance-anti-patterns>Performance Anti-Patterns<a class=headerlink href=#performance-anti-patterns title="Anchor link to this section for reference">&para;</a></h3> <ol> <li><strong>Never compute per-pixel operations with scipy Rbf</strong>:</li> <li>Rbf is designed for sparse interpolation, not dense image operations</li> <li>Always downsample before dense interpolation</li> <li> <p>Consider OpenCV alternatives for image-specific operations</p> </li> <li> <p><strong>Complexity Analysis Is Critical</strong>:</p> </li> <li>"3-15 seconds" seemed reasonable without analyzing O(N√óM)</li> <li>Always calculate worst-case complexity for image processing</li> <li> <p>1.2 billion operations is NOT acceptable for interactive UI</p> </li> <li> <p><strong>Test with Production-Scale Data</strong>:</p> </li> <li>Document flattening was likely tested on small test images</li> <li>Production images (2000√ó1500+) exposed the performance cliff</li> <li>Always test with largest expected input sizes</li> </ol> <h3 id=debugging-best-practices>Debugging Best Practices<a class=headerlink href=#debugging-best-practices title="Anchor link to this section for reference">&para;</a></h3> <ol> <li><strong>High CPU + No Progress = Complexity Explosion</strong>:</li> <li>Not a deadlock (would show 0% CPU)</li> <li>Not I/O wait (would show <code>D</code> state)</li> <li> <p>Likely tight computational loop - inspect innermost loops</p> </li> <li> <p><strong>Profile Before Optimizing</strong>:</p> </li> <li>Could have used cProfile to identify <code>rbf_x(x_coords, y_coords)</code> as bottleneck</li> <li> <p>Would have immediately revealed the per-pixel computation</p> </li> <li> <p><strong>Document Performance Characteristics</strong>:</p> </li> <li>Phase 2 noted "3-15s processing time" but didn't explain why</li> <li>Should have investigated and documented the O(N√óM) complexity</li> <li>Performance warnings should be prominent in code comments</li> </ol> <hr> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Anchor link to this section for reference">&para;</a></h2> <p>The RBF interpolation hang was caused by <strong>algorithmic complexity explosion</strong> (O(N√óM) with N=400, M=3M) that made document flattening effectively infinite for production images. The fix (downsampling to 800px before RBF computation) reduces complexity by ~63√ó while maintaining acceptable quality for document flattening use cases.</p> <p><strong>Status</strong>: ‚úÖ <strong>FIXED</strong> - App now processes pipelines with flattening in &lt;5 seconds.</p> <hr> <p><strong>Fix Commit</strong>: Applied 2025-10-18 <strong>Verification</strong>: Passed all manual tests <strong>Next Steps</strong>: Monitor performance in production, implement progress indicators and timeout protection as recommended</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="December 6, 2025 09:09:04 UTC"><span class=timeago datetime=2025-12-06T09:09:04+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="December 6, 2025 09:09:04 UTC">2025-12-06</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 19, 2025 07:52:51 UTC"><span class=timeago datetime=2025-10-19T07:52:51+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 19, 2025 07:52:51 UTC">2025-10-19</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> ¬© 2025 Woong Choi. All rights reserved. </div> </div> <div class=md-social> <a href=https://github.com/Wchoi189/upstageailab-ocr-recsys-competition-ocr-2 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://python.org target=_blank rel=noopener title=python.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../../../../js/timeago.min.js></script> <script src=../../../../js/timeago_mkdocs_material.js></script> <script src=../../../../javascripts/extra.js></script> </body> </html>