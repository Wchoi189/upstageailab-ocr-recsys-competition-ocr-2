# @package _group_

# @package _group_

defaults:
  - /data/transforms/base
  - _self_

dataset_base_path: "./data/datasets/"
batch_size: 4

data:
  train_num_samples: null
  val_num_samples: null
  test_num_samples: null

datasets:
  train_dataset:
    _target_: ocr.data.datasets.ValidatedOCRDataset
    config:
      _target_: ocr.core.validation.DatasetConfig
      image_path: ${dataset_base_path}images/train
      annotation_path: ${dataset_base_path}jsons/train.json
      enable_background_normalization: false
      cache_config:
        _target_: ocr.core.validation.CacheConfig
        cache_transformed_tensors: false
        cache_images: false
        cache_maps: false
        log_statistics_every_n: null
    transform: ${transforms.train_transform}
  val_dataset:
    _target_: ocr.data.datasets.ValidatedOCRDataset
    config:
      _target_: ocr.core.validation.DatasetConfig
      image_path: ${dataset_base_path}images_val_canonical
      annotation_path: ${dataset_base_path}jsons/val.json
      enable_background_normalization: false
      preload_images: false
      load_maps: false
      cache_config:
        _target_: ocr.core.validation.CacheConfig
        cache_transformed_tensors: false
        cache_images: false
        cache_maps: false
        log_statistics_every_n: null
    transform: ${transforms.val_transform}
  test_dataset:
    _target_: ocr.data.datasets.ValidatedOCRDataset
    config:
      _target_: ocr.core.validation.DatasetConfig
      image_path: ${dataset_base_path}images_val_canonical
      annotation_path: ${dataset_base_path}jsons/val.json
      enable_background_normalization: false
    transform: ${transforms.test_transform}
  predict_dataset:
    _target_: ocr.data.datasets.ValidatedOCRDataset
    config:
      _target_: ocr.core.validation.DatasetConfig
      image_path: ${dataset_base_path}images/test
      annotation_path: null
      enable_background_normalization: false
    transform: ${transforms.test_transform}

collate_fn:
  _target_: ocr.data.datasets.DBCollateFN
  shrink_ratio: 0.4
  thresh_min: 0.3
  thresh_max: 0.7
