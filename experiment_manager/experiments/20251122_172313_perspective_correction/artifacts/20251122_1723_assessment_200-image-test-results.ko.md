---
ads_version: '1.0'
type: assessment
experiment_id: 20251122_172313_perspective_correction
status: complete
created: '2025-12-17T17:59:47Z'
updated: '2025-12-27T16:16:42.724496'
tags:
- perspective-correction
- testing
- results
phase: phase_0
priority: medium
evidence_count: 0
title: 20251122 1723 평가 200-이미지-테스트-결과
---
# 200-이미지 종합 테스트 결과

**날짜**: 2025-11-22
**테스트 스크립트**: `test_perspective_comprehensive.py`
**데이터셋**: `data/datasets/images/train`의 200개 이미지
**상태**: ✅ 완료

---

## 실행 요약

200개 이미지에 대한 확장 테스트 결과, 초기 10개 이미지 테스트 대비 **성공률 향상** 확인:

- **성공률**: 73% (146/200) - 초기 테스트 60% 대비 상승
- **실패율**: 27% (54/200) - 초기 테스트 40% 대비 하락
- **폴백 사용률**: 27% (54/200) - 두 방법 모두 검증 실패
- **두 방법**: 동일한 성공/실패 패턴 (공유된 검출기 문제)

---

## 상세 결과

### 성공 지표

| 방법 | 유효한 결과 | 성공률 |
|--------|---------------|--------------|
| 일반 | 146/200 | 73.0% |
| DocTR | 146/200 | 73.0% |
| 폴백 | 54/200 | 27.0% |

**주요 발견**: 두 방법 모두 동일한 이미지에서 성공/실패하며, 문제가 방법별 이슈가 아닌 공유 코너 검출 로직에 있음을 확인.

### 실패 분석

**54개 실패 사례** 모두 동일한 근본 원인: **"영역 손실 과다"**

실패 분포:
- 영역 손실 13-20%: 3건 (5.6%)
- 영역 손실 20-30%: 4건 (7.4%)
- 영역 손실 30-40%: 8건 (14.8%)
- 영역 손실 40-50%: 39건 (72.2%)

**패턴**: 대부분의 실패(72%)가 40-50% 영역 손실 범위에 집중됨. 이는 다음을 시사:
1. 코너 검출이 유효 영역에 근접하지만 약간 작은 영역을 찾음
2. 50% 임계값은 적절하나 검출 정확도 개선 필요
3. 사전 보정 검증으로 많은 실패 방지 가능

### 성능 지표

**DocTR 방법**:
- 평균 검출 시간: ~0.003초
- 평균 보정 시간: ~0.005초
- 총계: ~0.008초/이미지 (유효 사례)

**일반 방법**:
- 평균 검출 시간: ~0.014초
- 평균 보정 시간: ~0.005초
- 총계: ~0.019초/이미지 (유효 사례)

**DocTR은 일반 방법 대비 ~2.4배 빠름** (유효 사례 기준).

---

## 근본 원인 분석

### 주요 문제: 코너 검출

**현재 설정**:
- `min_area_ratio=0.1` (이미지 영역의 10%)
- 너무 낮아 전체 문서 경계 대신 작은 텍스트 블록/아티팩트를 검출

**증거**:
- 모든 실패 사례에서 "영역 손실 과다" 발생 - 검출된 코너가 이미지 영역의 <50% 차지
- 두 방법 모두 동일하게 실패 (공유 검출기)
- 대부분의 실패가 40-50% 범위 (임계값 근접)

### 보조 문제: 사전 보정 검증 부재

**현재 흐름**:
1. 코너 검출 (유효하지 않을 수 있음)
2. 보정 적용 (불량 결과 생성 가능)
3. 결과 검증 (이미 계산 낭비 발생)

**누락 요소**:
- 보정 전 코너 품질 검증
- 무효 코너 조기 거부
- 작은 기울기 각도 시 보정 생략

---

## 권장 사항

### 우선순위 1: 코너 검출 개선

1. **`min_area_ratio` 증가**: 0.1 → 0.3 (이미지 영역의 30%)
   - 작은 영역 검출 방지
   - 사전 보정 검증 임계값과 일치

2. **DocTR 텍스트 기반 검출 테스트** (`use_doctr_text=True`)
   - 텍스트 문서에 더 나은 코너 검출 제공 가능
   - 성공률 추가 향상 기대

### 우선순위 2: 사전 보정 검증 통합

1. **보정 전 코너 검증 추가**:
   - 영역 비율 검사 (>이미지 영역의 30%)
   - 종횡비 검증 (이미지 대비 50-200% 이내)
   - 기울기 각도 검사 (<2° 시 생략)

2. **무효 코너 조기 거부**:
   - 코너가 너무 작을 경우 보정 생략
   - 기울기가 무시할 수 있을 경우 보정 생략
   - 원본 이미지 반환 및 사유 기록

### 우선순위 3: 적응형 임계값

1. **이미지 크기 기반 임계값**:
   - 큰 이미지는 다른 임계값 필요
   - 이미지 차원에 따른 적응형 `min_area_ratio`

2. **품질 기반 선택**:
   - 두 방법 모두 성공 시 품질 지표 기반 최적 결과 선택
   - 영역 보존율, 선명도, 대비 비교

---

## 예상 영향

### 개선 시

**현재**: 73% 성공률
**목표**: >85% 성공률

**개선 효과**:
- 사전 보정 검증: +5-10% (불량 보정 방지)
- 개선된 코너 검출: +5-10% (초기 검출 향상)
- 종합: +10-15% 개선 예상

**잔여 실패 사례**:
- 복잡한 레이아웃 (다중 문서)
- 심하게 왜곡된 이미지
- 낮은 대비 이미지
- 수동 개입 또는 고급 방법 필요

---

## 테스트 아티팩트

- **결과 JSON**: `artifacts/results.json` (200개 샘플)
- **출력 이미지**: `outputs/perspective_comprehensive/*.jpg`
- **비교 이미지**: 모든 샘플에 대한 나란히 비교

---

## 다음 단계

1. ✅ **결과 분석** (본 문서)
2. ⏳ **사전 보정 검증**을 종합 테스트에 통합
3. ⏳ **min_area_ratio**를 0.3으로 증가
4. ⏳ **실패 사례에 대한 개선 테스트**
5. ⏳ 200개 이미지에 대해 **종합 테스트 재실행**
6. ⏳ **결과 비교** 및 개선 검증

---

**평가 종료**
