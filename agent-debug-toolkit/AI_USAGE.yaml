# Agent Debug Toolkit (ADT) Usage Guide for AI Agents
# Version: 1.1 (Phase 3.2)

tools:
  resolve_hydra_configs:
    desc: Map Hydra config _target_ keys to Python files.
    args:
      config_dir: Path to config root (e.g., "configs")
      module_root: Path to module root (e.g., ".")
    example: |
      adt resolve-configs configs --module-root .

  analyze_config_access:
    desc: Find code using cfg.X or config['X'].
    args:
      path: File or directory path
    example: |
      adt analyze-config src/model.py

  trace_merge_order:
    desc: Debug OmegaConf.merge() precedence.
    args:
      file: Path to python file
    example: |
      adt trace-merges src/train.py

  find_hydra_usage:
    desc: Find @hydra.main, instantiate(), etc.
    args:
      path: File or directory path
    example: |
      adt find-hydra src/

  find_component_instantiations:
    desc: Track factory patterns like get_X_by_cfg().
    args:
      path: File or directory
      component: Optional filter (e.g., "encoder")
    example: |
      adt find-instantiations src/ --component encoder

  analyze_dependencies:
    desc: Build dependency graph (imports/calls).
    args:
       path: File or directory
    example: |
       adt analyze-dependencies src/

  analyze_complexity:
    desc: Check cyclomatic complexity/nesting.
    args:
       path: File/dir
       threshold: Int (default 10)
    example: |
       adt analyze-complexity src/ -t 15

  context_tree:
    desc: Generate annotated directory tree with docstrings and semantic labels.
    args:
       path: Directory to analyze
       depth: Max depth to traverse (default 3)
       output: Format - markdown (default), json, tree
    example: |
       adt context-tree ocr/recognition --depth 2
       adt context-tree agent-debug-toolkit/src --output json
    features:
       - Extracts module docstrings and __all__ exports
       - Detects special directories (tests, configs, models, data)
       - Lists key classes and functions with their docstrings
       - Provides rich context for AI agent navigation

  intelligent_search:
    desc: Search for symbols by name or qualified path with fuzzy matching.
    args:
      query: Symbol name or qualified path (e.g., "TimmBackbone" or "ocr.models.encoder.TimmBackbone")
      root: "Root directory to search (default: current directory)"
      fuzzy: "Enable fuzzy matching for typos (default: true)"
      threshold: "Minimum similarity 0.0-1.0 (default: 0.6)"
    example: |
       # Find by class name
       adt intelligent-search "ContextTreeAnalyzer" --root src/

       # Resolve qualified path
       adt intelligent-search "agent_debug_toolkit.analyzers.context_tree.ContextTreeAnalyzer"

       # Fuzzy search (handles typos)
       adt intelligent-search "ContextTreeAnalyer" --threshold 0.7
    features:
       - Resolves Hydra _target_ paths to file locations
       - Reverse lookup: find all import paths for a class
       - Fuzzy matching for typo correction (using difflib)
       - JSON or markdown output

concepts:
  symbol_table: "Internal service mapping definitions across files."
  resolution_status:
    RESOLVED: "Static match found."
    UNRESOLVED_DYNAMIC: "Interpolation detected (${...})."
    UNRESOLVED_RELATIVE: "Relative path not fully resolved."
    NOT_FOUND: "Symbol not in scanned codebase."
