decisions:
- alternatives_considered:
  - Keep files in scripts/ directory
  - Use separate documentation folder
  decision: Use experiment-tracker to organize all perspective correction experiments
  id: dec_001
  impact: All experiment-related scripts and assessments now centralized in experiment-tracker
  rationale: Better organization and tracking of experimental work compared to loose
    files in scripts/
  timestamp: 2025-11-22 17:23 (KST)
- alternatives_considered:
  - Use X11 forwarding
  - Use virtual display (Xvfb)
  - Try original ScanTailor for CLI
  decision: Skip ScanTailor integration due to compatibility issues (GUI-only, requires
    X11)
  id: dec_002
  impact: Focus shifted to improving existing algorithms rather than integrating external
    tool
  rationale: ScanTailor Advanced is GUI-only and requires X11 forwarding or virtual
    display, making it unsuitable for automated pipeline
  timestamp: 2025-11-23 00:28 (KST)
- alternatives_considered:
  - Keep 0.1 and rely only on post-validation
  - Use 0.2 as compromise
  - Use adaptive thresholds based on image size
  decision: Increase min_area_ratio from 0.1 to 0.3 for corner detection
  id: dec_003
  impact: Better initial corner detection, fewer false positives, reduced failure
    rate
  rationale: Original 0.1 was too low and detected small text blocks/artifacts instead
    of full document boundaries. 0.3 aligns with pre-validation threshold.
  timestamp: 2025-11-23 00:28 (KST)
- alternatives_considered:
  - Only post-correction validation
  - More lenient pre-validation thresholds
  decision: Implement pre-correction validation before applying perspective correction
  id: dec_004
  impact: 52% of failures now caught early, preventing wasted computation
  rationale: Prevents bad corrections before they happen, saves computation, provides
    early rejection of invalid corners
  timestamp: 2025-11-23 00:28 (KST)
- alternatives_considered:
  - Prefer DocTR for speed
  - Use quality metrics to choose
  decision: Prefer regular method over DocTR when both succeed (user feedback indicates
    better quality)
  id: dec_005
  impact: Current implementation already prefers regular, which aligns with user feedback
  rationale: User observation that regular method produces better perspective correction
    results despite being slower
  timestamp: 2025-11-23 00:40 (KST)
- alternatives_considered:
  - Keep scripts in scripts/ with symlinks
  - Create separate experiment directory structure
  decision: Move all experiment-related test scripts and documentation to experiment-tracker
  id: dec_006
  impact: All test scripts, documentation, and outputs now organized in experiment-tracker
  rationale: Keep related outputs inside designated experiment folders for better
    organization
  timestamp: 2025-11-23 00:51 (KST)
- alternatives_considered:
  - Keep ISO format for consistency
  - Use different timezone formats
  decision: Use human-readable timestamp format (YYYY-MM-DD HH:MM (KST)) instead of
    ISO format
  id: dec_007
  impact: Metadata files now use readable timestamps while maintaining ISO format
    in JSON for compatibility
  rationale: Improved readability for metadata files. ISO format still used in state.json
    for programmatic parsing.
  timestamp: 2025-11-23 13:00 (KST)
- alternatives_considered:
  - cv2 edge detection
  - 4 extreme points from contour
  - multi-point edge detection with line fitting
  decision: Implemented rembg mask-based perspective correction approach using mask
    edges for corner detection
  id: dec_008
  rationale: Rembg provides perfect object segmentation (100% reliable), so we can
    use the mask directly to find document boundaries instead of relying on cv2's
    brittle edge detection. Achieved 44% success rate on worst 50 performers, recovering
    22 previously failed cases.
  timestamp: 2025-11-23 14:57 (KST)
- alternatives_considered:
  - Continue tuning multi-point edge detection
  - Blend DocTR geometry with cv2 edges
  - Switch entirely to mask-driven fitting with heuristics
  decision: Adopt mask-only rectangle fitter with line-quality heuristics as the primary improved approach
  id: dec_009
  impact: Eliminates dependency on brittle image edges, enabling deterministic mask-driven corrections with explicit validation metrics
  rationale: Rembg masks already provide binary silhouettes; operating solely on mask data plus heuristics (edge support, solidity, parallelism) is simpler and more reliable than complex edge fusion
  timestamp: 2025-11-25 23:17 (KST)
- alternatives_considered:
  - Keep minAreaRect as the primary geometry source
  - Tune heuristics without changing the fitter
  - Blend mask bbox with hull without component filtering
  decision: Pivoted to largest-connected-component filtering plus approxPolyDP quadrilateral fitting
  id: dec_010
  impact: Prevents disjoint blobs from expanding the fit, enables trapezoidal corners that align with perspective skew, and enforces per-edge support floors to reject ghost lines
  rationale: minAreaRect forces an affine rectangle that under-fits trapezoids and is easily skewed by stray blobs; LCC + adaptive approxPolyDP yields tighter trapezoid fits while honoring mask evidence
  timestamp: 2025-11-26 12:15 (KST)
