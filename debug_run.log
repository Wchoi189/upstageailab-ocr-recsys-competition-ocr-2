INFO: Seed set to 42
[2026-01-14 16:50:34,488][lightning.fabric.utilities.seed][INFO] - Seed set to 42
[34mINFO    [0m ocr.features.recognition.data.tokenizer - Loaded tokenizer: [1;36m1023[0m chars, [33mvocab_size[0m=[1;36m1027[0m, [33mmax_len[0m=[1;36m25[0m                           
[2026-01-14 16:50:34,699][ocr.features.recognition.data.tokenizer][INFO] - Loaded tokenizer: 1023 chars, vocab_size=1027, max_len=25
[2026-01-14 16:50:34,972][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_small_patch16_224.augreg_in21k_ft_in1k)
[2026-01-14 16:50:35,351][timm.models._hub][INFO] - [timm/vit_small_patch16_224.augreg_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[34mINFO    [0m ocr.features.recognition.data.tokenizer - Loaded tokenizer: [1;36m1023[0m chars, [33mvocab_size[0m=[1;36m1027[0m, [33mmax_len[0m=[1;36m25[0m                           
[2026-01-14 16:50:35,449][ocr.features.recognition.data.tokenizer][INFO] - Loaded tokenizer: 1023 chars, vocab_size=1027, max_len=25
[34mINFO    [0m ocr.features.recognition.data.lmdb_dataset - LMDBRecognitionDataset: [1;36m616366[0m samples from                                      
         [35m/workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/[0m[95maihub_lmdb_validation[0m                        
[2026-01-14 16:50:35,458][ocr.features.recognition.data.lmdb_dataset][INFO] - LMDBRecognitionDataset: 616366 samples from /workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/aihub_lmdb_validation
[34mINFO    [0m ocr.features.recognition.data.tokenizer - Loaded tokenizer: [1;36m1023[0m chars, [33mvocab_size[0m=[1;36m1027[0m, [33mmax_len[0m=[1;36m25[0m                           
[2026-01-14 16:50:35,466][ocr.features.recognition.data.tokenizer][INFO] - Loaded tokenizer: 1023 chars, vocab_size=1027, max_len=25
[34mINFO    [0m ocr.features.recognition.data.lmdb_dataset - LMDBRecognitionDataset: [1;36m616366[0m samples from                                      
         [35m/workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/[0m[95maihub_lmdb_validation[0m                        
[2026-01-14 16:50:35,470][ocr.features.recognition.data.lmdb_dataset][INFO] - LMDBRecognitionDataset: 616366 samples from /workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/aihub_lmdb_validation
[34mINFO    [0m ocr.features.recognition.data.tokenizer - Loaded tokenizer: [1;36m1023[0m chars, [33mvocab_size[0m=[1;36m1027[0m, [33mmax_len[0m=[1;36m25[0m                           
[2026-01-14 16:50:35,480][ocr.features.recognition.data.tokenizer][INFO] - Loaded tokenizer: 1023 chars, vocab_size=1027, max_len=25
[34mINFO    [0m ocr.features.recognition.data.lmdb_dataset - LMDBRecognitionDataset: [1;36m616366[0m samples from                                      
         [35m/workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/[0m[95maihub_lmdb_validation[0m                        
[2026-01-14 16:50:35,485][ocr.features.recognition.data.lmdb_dataset][INFO] - LMDBRecognitionDataset: 616366 samples from /workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/aihub_lmdb_validation
[34mINFO    [0m ocr.features.recognition.data.tokenizer - Loaded tokenizer: [1;36m1023[0m chars, [33mvocab_size[0m=[1;36m1027[0m, [33mmax_len[0m=[1;36m25[0m                           
[2026-01-14 16:50:35,494][ocr.features.recognition.data.tokenizer][INFO] - Loaded tokenizer: 1023 chars, vocab_size=1027, max_len=25
[34mINFO    [0m ocr.features.recognition.data.lmdb_dataset - LMDBRecognitionDataset: [1;36m616366[0m samples from                                      
         [35m/workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/[0m[95maihub_lmdb_validation[0m                        
[2026-01-14 16:50:35,499][ocr.features.recognition.data.lmdb_dataset][INFO] - LMDBRecognitionDataset: 616366 samples from /workspaces/upstageailab-ocr-recsys-competition-ocr-2/data/processed/recognition/aihub_lmdb_validation
INFO: GPU available: True (cuda), used: True
[2026-01-14 16:50:36,460][lightning.pytorch.utilities.rank_zero][INFO] - GPU available: True (cuda), used: True
INFO: TPU available: False, using: 0 TPU cores
[2026-01-14 16:50:36,462][lightning.pytorch.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
wandb: Currently logged in as: wchoi189 (ocr-team2) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run 7fqa8d28
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in ./wandb/run-20260114_165038-7fqa8d28
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run user_parseq-timm-backbone-parseq-decoder-parseq-head-cross-entropy-bs32-lr1e-3_SCORE_PLACEHOLDER
wandb: â­ï¸ View project at https://wandb.ai/ocr-team2/receipt-text-recognition-ocr-project
wandb: ğŸš€ View run at https://wandb.ai/ocr-team2/receipt-text-recognition-ocr-project/runs/7fqa8d28
INFO: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
[2026-01-14 16:50:44,602][lightning.pytorch.accelerators.cuda][INFO] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ   â”ƒ Name   â”ƒ Type         â”ƒ Params â”ƒ Mode  â”ƒ
â”¡â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ 0 â”‚ model  â”‚ PARSeq       â”‚ 51.3 M â”‚ train â”‚
â”‚ 1 â”‚ metric â”‚ CLEvalMetric â”‚      0 â”‚ train â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
Trainable params: 51.3 M                                                                                                               
Non-trainable params: 0                                                                                                                
Total params: 51.3 M                                                                                                                   
Total estimated model params size (MB): 205                                                                                            
Modules in train mode: 443                                                                                                             
Modules in eval mode: 0                                                                                                                
/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/torch/nn/functional.py:5962: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
[2026-01-14 16:50:46,303][root][WARNING] - No val predictions found. This may indicate a data loading or prediction issue.
[2026-01-14 16:50:57,533][root][WARNING] - No val predictions found. This may indicate a data loading or prediction issue.
Epoch 0/1  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100/100 0:00:10 â€¢ 0:00:00 10.45it/s v_num: 8d28 val/recall: 0.000 val/precision:   
                                                                                        0.000 val/hmean: 0.000                         
Error executing job with overrides: ['domain=recognition', 'trainer=hardware_rtx3090_24gb_i5_16core', 'exp_name=rec_parseq_v1_debug', '+trainer.max_epochs=2', '+trainer.limit_train_batches=100', '+trainer.limit_val_batches=20']
Traceback (most recent call last):
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 49, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 598, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1011, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1055, in _run_stage
    self.fit_loop.run()
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/fit_loop.py", line 216, in run
    self.advance()
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/fit_loop.py", line 458, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/training_epoch_loop.py", line 153, in run
    self.on_advance_end(data_fetcher)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/training_epoch_loop.py", line 398, in on_advance_end
    self.val_loop.run()
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 152, in run
    return self.on_run_end()
           ^^^^^^^^^^^^^^^^^
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 309, in on_run_end
    self._on_evaluation_end()
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 354, in _on_evaluation_end
    call._call_callback_hooks(trainer, hook_name, *args, **kwargs)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 228, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py", line 397, in on_validation_end
    self._save_topk_checkpoint(trainer, monitor_candidates)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py", line 468, in _save_topk_checkpoint
    self._save_monitor_checkpoint(trainer, monitor_candidates)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py", line 802, in _save_monitor_checkpoint
    self._update_best_and_save(current, trainer, monitor_candidates)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py", line 854, in _update_best_and_save
    self._save_checkpoint(trainer, filepath)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py", line 473, in _save_checkpoint
    trainer.save_checkpoint(filepath, self.save_weights_only)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1395, in save_checkpoint
    checkpoint = self._checkpoint_connector.dump_checkpoint(weights_only)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/checkpoint_connector.py", line 501, in dump_checkpoint
    call._call_callbacks_on_save_checkpoint(trainer, checkpoint)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 255, in _call_callbacks_on_save_checkpoint
    callback.on_save_checkpoint(trainer, trainer.lightning_module, checkpoint)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/ocr/core/lightning/callbacks/unique_checkpoint.py", line 422, in on_save_checkpoint
    from ocr.core.utils.wandb_utils import _get_wandb
ImportError: cannot import name '_get_wandb' from 'ocr.core.utils.wandb_utils' (/workspaces/upstageailab-ocr-recsys-competition-ocr-2/ocr/core/utils/wandb_utils.py)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/runners/train.py", line 126, in train
    trainer.fit(
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 560, in fit
    call._call_and_handle_interrupt(
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 69, in _call_and_handle_interrupt
    _interrupt(trainer, exception)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 78, in _interrupt
    _call_callback_hooks(trainer, "on_exception", exception)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 228, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/ocr/core/lightning/callbacks/wandb_completion.py", line 48, in on_exception
    from ocr.core.utils.wandb_utils import _get_wandb
ImportError: cannot import name '_get_wandb' from 'ocr.core.utils.wandb_utils' (/workspaces/upstageailab-ocr-recsys-competition-ocr-2/ocr/core/utils/wandb_utils.py)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Exception ignored in atexit callback: <function _MultiProcessingDataLoaderIter._clean_up_worker at 0x756a81d15580>
Traceback (most recent call last):
  File "/workspaces/upstageailab-ocr-recsys-competition-ocr-2/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1612, in _clean_up_worker
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/vscode/.local/share/uv/python/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/multiprocessing/connection.py", line 948, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vscode/.local/share/uv/python/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt: 
[1;34mwandb[0m: 
[1;34mwandb[0m: ğŸš€ View run [33muser_parseq-timm-backbone-parseq-decoder-parseq-head-cross-entropy-bs32-lr1e-3_SCORE_PLACEHOLDER[0m at: [34m[0m
