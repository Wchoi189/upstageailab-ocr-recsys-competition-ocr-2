# Hydra configuration - placed directly here instead of using config group
# because @package directive doesn't work reliably with version_base=None
hydra:
  run:
    dir: ${paths.experiments_root}/${experiment.kind}/${experiment.task}/${experiment.name}/${experiment.run_id}
  sweep:
    dir: ${paths.experiments_root}/${experiment.kind}/${experiment.task}/${experiment.name}/multirun
    subdir: ${now:%Y%m%d_%H%M%S}_${hydra.job.num}
  job:
    chdir: true

# Task name for hydra logging (logical task label, not necessarily the path segment)
task_name: "train"

# Experiment identity used to construct the structured `outputs/experiments/...` path.
# Individual entry-point configs (train/test/predict/etc.) can override these fields.
experiment:
  kind: "train"          # train | eval | preproc | other
  task: "ocr"            # domain/task label (e.g., ocr, recsys, preproc)
  name: ${exp_name}      # comes from the entry config (e.g., train.yaml)
  run_id: ${now:%Y%m%d_%H%M%S}_${seed}

# OVERRIDE PATTERN GUIDE:
# Configs listed in defaults below → override WITHOUT + prefix (e.g., logger=wandb)
# Configs NOT in defaults → override WITH + prefix (e.g., +ablation=model_comparison)
defaults:
  - model: default          # Override: model=X
  - data: default           # Override: data=canonical, data=craft (no + needed)
  - evaluation: metrics     # Override: evaluation=X
  - paths: default          # Override: paths=X
  - logger: consolidated    # Override: logger=wandb, logger=csv (no + needed)
  - trainer: default        # Override: trainer=fp16_safe, trainer=rtx3060_12gb (no + needed)
  - callbacks: default      # Override: callbacks=X
  - debug: default          # Override: debug=X
  # NOTE: hydra config moved inline above - config groups don't work with @package in version_base=None

# Runtime extras (inlined from extras/default.yaml)
# disable python warnings if they annoy you
ignore_warnings: False

# ask user for tags if none are provided in the config
enforce_tags: True

# pretty print config tree at the start of the run using Rich library
print_config: True

dataset_module: ocr.datasets
dataset_config_module: ocr.datasets.schemas

# Model and component paths
dataset_path: ${dataset_module}
dataset_config_path: ${dataset_config_module}
model_path: ocr.models
encoder_path: ocr.models.encoder
decoder_path: ocr.models.decoder
head_path: ocr.models.head
loss_path: ocr.models.loss
lightning_path: ocr.lightning_modules
