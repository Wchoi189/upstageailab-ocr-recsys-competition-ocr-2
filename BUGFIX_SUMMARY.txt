â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    API PROXY BUG FIX - RESOLVED                    â•‘
â•‘                      December 10, 2025                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› BUG IDENTIFIED

Error: "Failed to load resource: :3000/api/api/v1/health"
Issue: Double "/api" prefix in API calls

ROOT CAUSE:
  â€¢ Vite proxy configured: /api â†’ http://localhost:8080
  â€¢ bridgeService.ts was prepending API_URL (/api) to endpoints
  â€¢ Endpoints already included /api prefix (e.g., /api/v1/health)
  â€¢ Result: /api + /api/v1/health = /api/api/v1/health (WRONG)

ğŸ“‹ FIX APPLIED

File: apps/agentqms-dashboard/frontend/services/bridgeService.ts

Changed all endpoint calls from:
  âœ— '/api/v1/health'
  âœ— '/api/v1/artifacts'
  âœ— '/api/v1/compliance/validate'

To:
  âœ“ '/v1/health'
  âœ“ '/v1/artifacts'
  âœ“ '/v1/compliance/validate'

RATIONALE:
  The fetchJson() function already prepends API_URL (/api) to all endpoints,
  so the endpoints should NOT include /api prefix.

FLOW (CORRECTED):
  1. Component calls: bridgeService.getHealth()
  2. Function calls: fetchJson('/v1/health')
  3. fetchJson prepends: /api + /v1/health = /api/v1/health
  4. Vite proxy rewrites: /api/v1/health â†’ http://localhost:8080/api/v1/health
  5. Backend receives: /api/v1/health âœ“ (CORRECT)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… CHANGES MADE

File: apps/agentqms-dashboard/frontend/services/bridgeService.ts

Lines changed:
  â€¢ Line 155: /api/v1/health â†’ /v1/health
  â€¢ Line 161: /api/v1/version â†’ /v1/version
  â€¢ Line 171: /api/v1/artifacts â†’ /v1/artifacts
  â€¢ Line 179: /api/v1/artifacts/{id} â†’ /v1/artifacts/{id}
  â€¢ Line 185: /api/v1/artifacts â†’ /v1/artifacts
  â€¢ Line 193: /api/v1/artifacts/{id} â†’ /v1/artifacts/{id}
  â€¢ Line 201: /api/v1/artifacts/{id} â†’ /v1/artifacts/{id}
  â€¢ Line 209: /api/v1/compliance/validate â†’ /v1/compliance/validate

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ CODE QUALITY

  âœ“ No TypeScript errors
  âœ“ No linting errors
  âœ“ Type hints preserved
  âœ“ All interfaces intact

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ§ª NEXT STEPS TO VERIFY

1. Restart frontend dev server:
   cd apps/agentqms-dashboard/frontend
   npm run dev

2. Check browser console for errors:
   Should see: Successful health check (no 404)
   Should NOT see: /api/api/v1/health

3. Test API calls:
   curl http://localhost:3000/api/v1/health (proxied to 8080)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ IMPORTANT: BACKEND MUST STILL USE /api PREFIX

Backend routes registered as:
  âœ“ @app.get("/api/v1/health")
  âœ“ @app.get("/api/v1/artifacts")
  âœ“ @app.post("/api/v1/artifacts")
  etc.

The /api prefix is REQUIRED on the backend. Only the frontend
endpoint calls in bridgeService should use /v1 (without /api).

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
