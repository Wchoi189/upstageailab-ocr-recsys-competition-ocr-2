---
# Project Compass Active Session
session_id: "2026-01-08-Hydra-Config-Restructure"
status: "active"
started_date: "2026-01-08"
completed_date: null

objective: |
  Hydra Configuration Architecture Restructuring: Restructure from 107 YAML files/37
  directories to ~50 files/15 directories with domain-first organization.

implementation_plan: "docs/artifacts/implementation_plans/2026-01-08_0359_implementation_plan_hydra-config-restructuring.md"
source_walkthrough: "docs/artifacts/walkthroughs/2026-01-05_0441_Hydra-Config-Architecture-Restructuring.md"

phases:
  phase_0_discovery:
    status: "completed"
    description: "Analyze current configuration dependencies using Agent Debug Toolkit"
    tasks:
      - "✅ Map all Hydra entry points (14 entry points found across runners/)"
      - "✅ Analyze config access patterns in runners/ (120 findings)"
      - "✅ Create baseline snapshot (107 YAML files, 37 directories confirmed)"
      - "✅ Analyze component instantiation patterns (814 factory patterns found)"
      - "✅ Generate config flow documentation (train.py: 17 accesses, 10 components)"
    outputs:
      - "analysis/hydra_entry_points.json"
      - "analysis/configs_structure_before.txt"
      - "analysis/file_count_before.txt"
      - "analysis/component_factories.json"
      - "analysis/phase0_summary.md"
    findings:
      - "Main entry points: train.py, test.py, predict.py, generate_synthetic.py, train_kie.py"
      - "Config access primarily through config.get(), config.paths.*, config.model.*, config.trainer.*"
      - "Baseline: 107 YAML files / 37 directories (matches expected)"
      - "Component factories: get_encoder_by_cfg, get_decoder_by_cfg, get_head_by_cfg, get_loss_by_cfg, get_datasets_by_cfg"
      - "Config flow in train.py: 17 config accesses, 0 merge operations, 4 Hydra operations, 10 component instantiations"

  phase_1_foundation:
    status: "pending"
    description: "Non-breaking foundation changes"
    tasks:
      - "Create new directory structure"
      - "Rename _base/ to _foundation/"
      - "Create _foundation/defaults.yaml"
      - "Update README.md"

  phase_2_domain:
    status: "pending"
    description: "Domain unification"
    tasks:
      - "Create domain configs (detection, recognition, kie, layout)"
      - "Verify domain configs compose"

  phase_3_entrypoints:
    status: "pending"
    description: "Entry point simplification"
    tasks:
      - "Update train.yaml with domain composition"
      - "Rename test.yaml to eval.yaml"
      - "Archive KIE variant configs"

  phase_4_infrastructure:
    status: "pending"
    description: "Infrastructure reorganization"
    tasks:
      - "Move training infrastructure (callbacks, logger)"
      - "Merge UI directories"
      - "Move examples and benchmarks"

  phase_5_scripts:
    status: "pending"
    description: "Script updates"
    tasks:
      - "Find all Hydra entry points"
      - "Update runner scripts"
      - "Update test/evaluation scripts"
      - "Update performance benchmark scripts"

  phase_6_verification:
    status: "pending"
    description: "Verification and validation"
    tasks:
      - "Hydra composition tests"
      - "Smoke test training"
      - "Validate with AgentQMS"
      - "Compare before/after metrics"

  phase_7_documentation:
    status: "pending"
    description: "Documentation and cleanup"
    tasks:
      - "Update main documentation"
      - "Create migration cheatsheet"
      - "Remove old base.yaml"

  phase_8_cicd:
    status: "pending"
    description: "CI/CD updates"
    tasks:
      - "Update GitHub Actions"
      - "Update Docker configs"

current_task: "Phase 1: Foundation Setup"

notes: |
  Session handover documentation moved to: project_compass/session_handover.md

  Phase 0 Complete ✅ - All discovery tasks finished using MCP tools.
  Ready to begin Phase 1 (non-breaking foundation changes).

references:
  - "AGENTS.yaml - Root-level project resource index"
  - "AgentQMS/standards/workflow_standards.yaml - Development patterns"
  - "AgentQMS/standards/naming_standards.yaml - Naming conventions"
  - "AgentQMS/standards/artifact_standards.yaml - Artifact templates"
  - "project_compass/AI_ENTRYPOINT.md - Session lifecycle protocol"
  - "analysis/phase0_summary.md - Complete Phase 0 findings"
  - "docs/artifacts/implementation_plans/2026-01-08_0359_implementation_plan_hydra-config-restructuring.md"

blockers: []

notes:
  - "Requires stakeholder approval before execution"
  - "Breaking changes to config entry points"
  - "Git branch: refactor/hydra (already exists)"

tools_required:
  - "Agent Debug Toolkit (ADT)"
  - "AgentQMS CLI"
  - "uv package manager"

success_criteria:
  - "Total YAML files < 60"
  - "Directory count < 20"
  - "Root-level configs ≤ 5"
  - "All compositions pass"
  - "Smoke tests pass"
  - "AgentQMS validation passes"
