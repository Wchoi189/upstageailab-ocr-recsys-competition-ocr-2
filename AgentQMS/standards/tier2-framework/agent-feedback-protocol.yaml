ads_version: "1.0"
type: rule_set
title: "Agent-in-the-Loop Feedback Protocol"
agent: all
tier: 2
priority: critical
validates_with: "AgentQMS/standards/schemas/compliance-checker.py"
compliance_status: unknown
memory_footprint: 300
description: "Protocol for handling runtime telemetry feedback and enforcement."

mechanisms:
  compliance:
    rule_1:
      name: "No System Path Hacks"
      violation: "sys.path.append() OR sys.path.insert()"
      correction: "Use PYTHONPATH or AgentQMS.tools.utils.paths"
      override: true
    rule_2:
      name: "Environment Consistency"
      violation: "python script.py"
      correction: "uv run python script.py"
      override: false

  redundancy:
    rule_1:
      name: "Artifact Duplication"
      violation: "Creating artifact managed in .gemini/"
      correction: "Reference managed artifact"
      override: false

protocol:
  trigger: "Tool Error: ⚠️ FEEDBACK TRIGGERED:"
  response_steps:
    1: "STOP execution"
    2: "READ feedback_to_ai"
    3: "CORRECT argument/approach"

  force_override:
    condition: "False positive OR critical exception"
    action: "Add argument: force=True"
    example: "call_tool('run_command', {'force': True, ...})"

telemetry:
  logging: "All violations tracked"
  impact: "Trust score penalty"
