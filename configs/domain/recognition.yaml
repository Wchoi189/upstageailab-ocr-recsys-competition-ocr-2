# @package _group_
# v5.0 | Purpose: Master Controller for Text Recognition (PARSeq)
# Validated: 2026-01-18 | Deps: model/presets/parseq, data/recognition
# ============================================================================
# DOMAIN CONTROLLER TEMPLATE - Recognition Example
# ============================================================================
# Purpose: Serve as the master logic switch for a specific domain
# Location: configs/domain/recognition.yaml
#
# This file demonstrates the "Domain Controller" pattern that enforces
# strict domain isolation and prevents configuration leakage.
# ============================================================================

defaults:
  - _self_
  # Component selections for this domain
  - /global/paths
  - /model/presets/parseq
  - /data/recognition

  # Optional: training configuration

# ============================================================================
# CRITICAL: Domain Isolation - Nullify Other Domains
# ============================================================================
# These explicit nullifications prevent "ghost variables" that cause:
# - CUDA segfaults
# - Unexpected behavior
# - AI agent confusion
#
# Rule: If a key belongs to another domain, it MUST be set to null here.
# ============================================================================

# Nullify Detection Domain
detection: null
max_polygons: null
shrink_ratio: null
thresh_min: null
thresh_max: null
box_thresh: null
unclip_ratio: null

# Nullify KIE Domain
kie: null
max_entities: null
relation_types: null
entity_categories: null
linking_mode: null

# ============================================================================
# Recognition-Specific Configuration
# ============================================================================

recognition:
  # Character recognition settings
  max_label_length: 25
  charset: korean
  case_sensitive: false

  # Decoding strategy
  decode_mode: greedy  # Options: greedy, beam_search
  beam_width: 5        # Only used if decode_mode=beam_search

  # Special tokens
  use_eos_token: true
  use_pad_token: true

# ============================================================================
# Domain Metadata (Optional but Recommended)
# ============================================================================

domain_info:
  name: recognition
  description: "Korean text recognition using PARSeq architecture"
  version: "2.0"

  # Validation rules for runtime checks
  required_keys:
    - recognition.max_label_length
    - recognition.charset

  forbidden_keys:
    - max_polygons
    - max_entities

# ============================================================================
# Adaptation Guide for Other Domains
# ============================================================================
