flowchart TD
    A[Failure Detected] --> B[Drafting Phase]
    B --> C[Capture Raw Observations]
    C --> D[Logs, Screenshots, Context]
    D --> E[Synthesis Phase]
    E --> F[Generate Technical Incident Report]
    F --> G[Assessment Phase]
    G --> H{Quality Rubric Check}

    H -->|Root Cause Depth| I1[Deep enough?]
    H -->|Evidence Quality| I2[Artifacts linked?]
    H -->|Remediation Logic| I3[Addresses root cause?]
    H -->|Metric Impact| I4[Quantifiable prediction?]

    I1 --> J{All Pass?}
    I2 --> J
    I3 --> J
    I4 --> J

    J -->|Fail| K[Revision Required]
    K --> F
    J -->|Pass| L[Committal Phase]
    L --> M[Save to incident_reports/]
    M --> N[Create Task Tickets]
    N --> O[Link to Experiment]
    O --> P[Track Metrics Impact]

    style A fill:#ff6b6b
    style H fill:#ffd93d
    style J fill:#ffd93d
    style L fill:#6bcf7f
    style P fill:#4ecdc4

    classDef phase fill:#e8f4f8,stroke:#2c3e50,stroke-width:2px
    classDef check fill:#fff3cd,stroke:#856404,stroke-width:2px
    classDef success fill:#d4edda,stroke:#155724,stroke-width:2px
    classDef failure fill:#f8d7da,stroke:#721c24,stroke-width:2px

    class B,E,G,L phase
    class H,J check
    class L,M,N,O,P success
    class A,K failure
