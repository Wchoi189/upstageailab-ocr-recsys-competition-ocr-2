---
# Tier 1 - Critical Workflow Rules
# EDS v1.0 Artifact Creation/Modification Protocols

specification_version: "1.0"
source: "EDS v1.0 Section: workflow_requirements"
enforcement: "critical"
auto_block: true

manual_artifact_creation:
  allowed: false
  severity: "critical"
  reasoning: "Prevents ALL-CAPS chaos, missing frontmatter, incorrect placement"
  enforcement: "pre_commit_hook"
  error_message: |
    ❌ CRITICAL: Manual artifact creation detected

    Manually created file: {filename}
    Missing: auto-generated frontmatter, correct naming, correct placement

    EDS v1.0 REQUIRES CLI-generated artifacts to ensure:
    - Correct frontmatter (ads_version, type, experiment_id, created, updated, status, tags)
    - Correct naming (YYYYMMDD_HHMM_{TYPE}_{slug}.md)
    - Correct placement (.metadata/subdirectory/)

    Use CLI commands instead:
    - generate-assessment --experiment {experiment_id}
    - generate-report --experiment {experiment_id}
    - generate-guide --experiment {experiment_id}
    - generate-script --experiment {experiment_id}

    Delete manually created file and regenerate using CLI

required_cli_commands:
  generate_assessment:
    command: "eds generate-assessment --experiment {experiment_id} --slug {slug}"
    purpose: "Create failure analysis assessment with auto-generated frontmatter"
    auto_generates:
      - "YYYYMMDD_HHMM timestamp"
      - "experiment_id field"
      - "created/updated ISO8601 timestamps"
      - "status: draft"
      - "ads_version: 1.0"
      - "type: assessment"
    places_in: "experiments/{experiment_id}/.metadata/assessments/"
  generate_report:
    command: "eds generate-report --experiment {experiment_id} --slug {slug}"
    purpose: "Create metrics report with auto-generated frontmatter"
    auto_generates:
      - "YYYYMMDD_HHMM timestamp"
      - "experiment_id field"
      - "created/updated ISO8601 timestamps"
      - "status: draft"
      - "ads_version: 1.0"
      - "type: report"
    places_in: "experiments/{experiment_id}/.metadata/reports/"
  generate_guide:
    command: "eds generate-guide --experiment {experiment_id} --slug {slug}"
    purpose: "Create command guide with auto-generated frontmatter"
    auto_generates:
      - "YYYYMMDD_HHMM timestamp"
      - "experiment_id field"
      - "created/updated ISO8601 timestamps"
      - "status: draft"
      - "ads_version: 1.0"
      - "type: guide"
    places_in: "experiments/{experiment_id}/.metadata/guides/"
  generate_script:
    command: "eds generate-script --experiment {experiment_id} --slug {slug}"
    purpose: "Create executable script artifact with auto-generated frontmatter"
    auto_generates:
      - "YYYYMMDD_HHMM timestamp"
      - "experiment_id field"
      - "created/updated ISO8601 timestamps"
      - "status: draft"
      - "ads_version: 1.0"
      - "type: script"
    places_in: "experiments/{experiment_id}/.metadata/scripts/"

frontmatter_requirements:
  universal_fields:
    ads_version:
      required: true
      format: "X.Y"
      example: "1.0"
    type:
      required: true
      enum: ["assessment", "report", "guide", "script", "manifest"]
    experiment_id:
      required: true
      pattern: "YYYYMMDD_HHMMSS_name"
      example: "20251217_024343_image_enhancements"
    status:
      required: true
      enum: ["draft", "active", "complete", "deprecated"]
      default: "draft"
    created:
      required: true
      format: "ISO8601 datetime"
      example: "2025-12-17T15:30:00Z"
    updated:
      required: true
      format: "ISO8601 datetime"
      example: "2025-12-17T15:30:00Z"
    tags:
      required: true
      format: "array of lowercase-hyphenated strings"
      example: ["failure-analysis", "shadow-removal", "phase-2"]

  type_specific_fields:
    assessment:
      required: ["phase", "priority", "evidence_count"]
    report:
      required: ["metrics", "baseline", "comparison"]
    guide:
      required: ["commands", "prerequisites"]
    script:
      required: ["dependencies"]

modification_rules:
  draft_status:
    allowed_modifications: "unrestricted"
    reasoning: "Iterative development phase"
  active_status:
    allowed_modifications: "content updates only"
    prohibited: "frontmatter changes (except updated timestamp)"
  complete_status:
    allowed_modifications: "corrections only"
    prohibited: "substantial content changes"
  deprecated_status:
    allowed_modifications: "none"
    action: "read-only, 30-day retention before deletion"

validation_command: "eds_workflow_validate"
error_message: |
  ❌ CRITICAL: Workflow violation detected

  Violation: {violation_type}
  File: {filename}

  EDS v1.0 Workflow Requirements:
  1. ALL artifacts MUST be created via CLI commands
  2. Manual creation is PROHIBITED (causes ALL-CAPS chaos)
  3. CLI tools auto-generate correct frontmatter, naming, placement

  Available commands:
  - eds generate-assessment --experiment {experiment_id} --slug {slug}
  - eds generate-report --experiment {experiment_id} --slug {slug}
  - eds generate-guide --experiment {experiment_id} --slug {slug}
  - eds generate-script --experiment {experiment_id} --slug {slug}

  Fix: Delete manually created file, regenerate using CLI
