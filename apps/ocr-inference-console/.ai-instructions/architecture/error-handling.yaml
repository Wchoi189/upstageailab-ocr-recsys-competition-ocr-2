---
# Error Handling Architecture
# Location: apps/ocr-inference-console/backend/exceptions.py

exception_hierarchy:
  OCRBackendError:
    module: "backend.exceptions"
    base: "Exception"
    fields:
      error_code: "str"
      message: "str"
      details: "dict"

  CheckpointNotFoundError:
    extends: "OCRBackendError"
    error_code: "CHECKPOINT_NOT_FOUND"
    http_status: 404
    details: ["checkpoint_path"]

  ImageDecodingError:
    extends: "OCRBackendError"
    error_code: "IMAGE_DECODING_ERROR"
    http_status: 400
    details: ["reason"]

  InferenceError:
    extends: "OCRBackendError"
    error_code: "INFERENCE_ERROR"
    http_status: 500
    details: ["reason"]

  ModelLoadError:
    extends: "OCRBackendError"
    error_code: "MODEL_LOAD_ERROR"
    http_status: 500
    details: ["checkpoint_path", "reason"]

  ServiceNotInitializedError:
    extends: "OCRBackendError"
    error_code: "SERVICE_NOT_INITIALIZED"
    http_status: 500
    details: ["service_name"]

# Error handler (main.py)
global_handler:
  decorator: "@app.exception_handler(OCRBackendError)"
  mapping:
    CHECKPOINT_NOT_FOUND: 404
    IMAGE_DECODING_ERROR: 400
    INFERENCE_ERROR: 500
    MODEL_LOAD_ERROR: 500
    SERVICE_NOT_INITIALIZED: 500
  response_model: "ErrorResponse"

# ErrorResponse schema (models/errors.py)
error_response:
  fields:
    error_code: "str"
    message: "str"
    details: "dict"
    request_id: "str | None"
