ads_version: '2.0'
type: rule_set
agent: copilot
tier: 2
priority: high
pattern:
  name: config_externalization
  scope: AgentQMS/tools/core/*.py
  identify:
    externalize:
    - hardcoded_lists
    - hardcoded_dicts
    - magic_numbers
    - repeated_values
    - format_strings
    skip:
    - computed_values
    - loop_vars
    - temp_structures
    - runtime_data
  structure:
    config_file: AgentQMS/standards/tier2-framework/config-externalization/{module_name}_config.yaml
    sections: logical_grouping
    defaults: all_keys_have_fallbacks
    comments: minimal_essential_only
  python_changes:
    imports:
    - from: AgentQMS.tools.utils.config_loader
      import: ConfigLoader
    init:
    - self._config_loader = ConfigLoader(cache_size=5)
    - self._config_cache = None
    methods:
      _get_config:
        purpose: cached_access
        returns: dict[str, Any]
        pattern: "if self._config_cache is None:\n    self._config_cache = self._load_config()\n\
          return self._config_cache\n"
      _load_config:
        purpose: load_with_fallbacks
        returns: dict[str, Any]
        pattern: 'config_path = Path(__file__).resolve().parents[2] / "standards"
          / "tier2-framework" / "config-externalization" / "{module}_config.yaml"

          defaults = {...}

          return self._config_loader.get_config(config_path, defaults=defaults)

          '
    usage:
      pattern: 'config = self._get_config()

        value = config.get("key", fallback)

        '
  validation:
  - config_file_valid_yaml
  - all_keys_in_defaults
  - no_behavioral_change
  - tests_pass_without_config
  - tests_pass_with_config
  metrics:
    time_per_module: 30-45_min
    first_module: 2-3_hours
    risk: very_low
id: FW-010
validates_with: AgentQMS/standards/schemas/compliance-checker.py
compliance_status: unknown
memory_footprint: 100
keywords:
- pattern
fuzzy_threshold: 0.8
